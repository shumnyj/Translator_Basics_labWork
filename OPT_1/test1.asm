;SP1
DATA SEGMENT
 IDEN1 dd ?
 AB dd ?
DATA ENDS

CODE SEGMENT
 ASSUME ds:DATA, cs:CODE
 begin:
 MOV AX, DATA
 MOV DS,AX

 MOV EAX,0
 NOP ;empty
 MOV EBX, EAX; bottom
 MOV EAX,2
 IMUL EAX,5
 NOP ;empty
 XCHG EBX, EAX ; top

 MOV IDEN1,EAX
 MOV EAX,EBX
 CMP EAX,IDEN1
 JL ?L0
 MOV EDX,1
 SUB EAX, IDEN1
 INC EAX
 MOV ECX, EAX
?L1: NOP
 MOV EAX,1
 NOP ;empty
 MOV EBX, EAX; bottom
 MOV EAX,IDEN1
 IMUL EAX,5
 IDIV 23
 MOV EAX, EDX
 NOP ;empty
 XCHG EBX, EAX ; top

 MOV AB,EAX
 MOV EAX,EBX
 CMP EAX,AB
 JL ?L1
 MOV EDX,1
 SUB EAX, AB
 INC EAX
 MOV ECX, EAX
?L2: NOP
 NOP

 MOV EAX, AB
 DEC EAX
 MOV AB,EAX
 LOOP ?L2
?L1: NOP

 NOP

 MOV EAX, IDEN1
 DEC EAX
 MOV IDEN1,EAX
 LOOP ?L1
?L0: NOP

 NOP

 MOV AX, 4c00h
 INT 21h
CODE ENDS
 END begin


